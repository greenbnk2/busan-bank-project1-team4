<div th:replace="~{cs/_head.html}"></div>
    <div th:replace="~{cs/_sidebar :: sidebarFragment}"></div>

    <main>
        <h2>FAQ(자주하시는 질문)</h2>

        <div class="explain">
            <ul>
                <li>부산은행 웹사이트 이용시 자주하는 질문을 정리하였습니다.</li>
                <li>원하는 질문 및 답변을 바로 찾으시려면 검색을 이용하여 주십시오.</li>
            </ul>
        </div>

        <!-- ===================== 검색 ===================== -->
        <section class="searchwords">
            <form th:action="@{/cs/customerSupport/faq}" method="get" class="searchbar">
                <label for="faq-search">FAQ 검색</label>

                <input type="text" id="faq-search" name="keyword"
                       th:value="${pageRequestDTO.keyword}">

                <select name="searchType">
                    <option value="question"
                            th:selected="${pageRequestDTO.searchType} == 'question'">질문</option>
                    <option value="answer"
                            th:selected="${pageRequestDTO.searchType} == 'answer'">답변</option>
                    <option value="qa"
                            th:selected="${pageRequestDTO.searchType} == 'qa'">질문+답변</option>
                </select>

                <!-- 선택중 카테고리 유지 -->
                <input type="hidden" name="cate" th:value="${pageRequestDTO.cate}">

                <button type="submit">검색</button>
            </form>

            <div class="popular-words">
                <span>인기검색어</span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='예금')}">예금</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='대출')}">대출</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='카드')}">카드</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='디지털OTP')}">디지털OTP</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='한도제한계좌')}">한도제한계좌</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='모바일뱅킹')}">모바일뱅킹</a></span>
                <span><a th:href="@{/cs/customerSupport/faq(searchType='qa', keyword='국민주택채권')}">국민주택채권</a></span>
            </div>
        </section>

        <!-- ===================== 카테고리 ===================== -->
        <section class="top-words">

            <!-- TOP -->
            <a th:href="@{/cs/customerSupport/faq}"
               th:classappend="${pageRequestDTO.cate == null or pageRequestDTO.cate == ''} ? ' active' : ''">
                TOP
            </a>

            <!-- 코드테이블 카테고리 -->
            <a th:each="cat : ${faqCategories}"
               th:href="@{/cs/customerSupport/faq(cate=${cat.code})}"
               th:text="${cat.codeName}"
               th:classappend="${pageRequestDTO.cate == cat.code} ? ' active'">
            </a>
        </section>

        <!-- ===================== FAQ 리스트 ===================== -->
        <section class="question">
            <ul>
                <li th:each="faq : ${pageResponseDTO.dtoList}">
                    <div class="faq-question">
                        <span class="q-icon">Q</span>
                        <span th:text="${faq.question}"></span>
                    </div>

                    <div class="faq-answer" th:utext="${faq.answer}"></div>
                </li>

                <li th:if="${#lists.isEmpty(pageResponseDTO.dtoList)}">
                    등록된 FAQ가 없습니다.
                </li>
            </ul>
        </section>

        <!-- ===================== 페이지네이션 ===================== -->
        <div class="pagination"
             th:if="${(pageRequestDTO.cate != null and pageRequestDTO.cate != '')
              or (pageRequestDTO.keyword != null and pageRequestDTO.keyword != '')}">

            <a th:href="@{/cs/customerSupport/faq(
                    pg=1,
                    size=${pageResponseDTO.size},
                    cate=${pageRequestDTO.cate},
                    searchType=${pageRequestDTO.searchType},
                    keyword=${pageRequestDTO.keyword})}">
                &laquo;&laquo;
            </a>

            <!-- < 한 칸 앞으로 (1페이지에서는 숨김) -->
            <a th:if="${pageResponseDTO.pg > 1}"
               th:href="@{/cs/customerSupport/faq(
                    pg=${pageResponseDTO.pg - 1},
                    size=${pageResponseDTO.size},
                    cate=${pageRequestDTO.cate},
                    searchType=${pageRequestDTO.searchType},
                    keyword=${pageRequestDTO.keyword})}">
                &laquo;
            </a>

            <!-- 가운데 숫자 (블럭 기준) -->
            <a th:each="p : ${#numbers.sequence(pageResponseDTO.start, pageResponseDTO.end)}"
               th:href="@{/cs/customerSupport/faq(
                    pg=${p},
                    size=${pageResponseDTO.size},
                    cate=${pageRequestDTO.cate},
                    searchType=${pageRequestDTO.searchType},
                    keyword=${pageRequestDTO.keyword})}"
               th:text="${p}"
               th:classappend="${p == pageResponseDTO.pg} ? ' active'">
            </a>

            <!-- > 한 칸 뒤로 (마지막 페이지에서는 숨김) -->
            <a th:if="${pageResponseDTO.pg < pageResponseDTO.last}"
               th:href="@{/cs/customerSupport/faq(
                    pg=${pageResponseDTO.pg + 1},
                    size=${pageResponseDTO.size},
                    cate=${pageRequestDTO.cate},
                    searchType=${pageRequestDTO.searchType},
                    keyword=${pageRequestDTO.keyword})}">
                &raquo;
            </a>

            <!-- >> 마지막 페이지 -->
            <a th:href="@{/cs/customerSupport/faq(
                    pg=${pageResponseDTO.last},
                    size=${pageResponseDTO.size},
                    cate=${pageRequestDTO.cate},
                    searchType=${pageRequestDTO.searchType},
                    keyword=${pageRequestDTO.keyword})}">
                &raquo;&raquo;
            </a>
        </div>
    </main>
</div>

<div th:replace="~{cs/_tail.html}"></div>
<script th:src="@{/js/cs/sidebar.js}"></script>
<script th:src="@{/js/cs/faqToggle.js}"></script>
</body>
</html>
